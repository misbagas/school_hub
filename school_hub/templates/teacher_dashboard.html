<!-- teacher_dashboard.html -->
<div class="container mt-4">
    <h2>View Joined Students</h2>
    <div class="mb-3">
        <label for="classCode" class="form-label">Enter Class Code</label>
        <input type="text" class="form-control" id="classCode" placeholder="Enter class code" required>
        <button id="viewJoinedBtn" class="btn btn-primary mt-2">View Joined Students</button>
    </div>

    <h3>Students Who Have Joined</h3>
    <ul id="joinedStudentsList">
        <!-- This will be populated dynamically -->
    </ul>
</div>

<script>
    document.getElementById('viewJoinedBtn').addEventListener('click', () => {
        const classCode = document.getElementById('classCode').value;

        fetch(`/get_joined_students?class_code=${classCode}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            const joinedStudentsList = document.getElementById('joinedStudentsList');
            joinedStudentsList.innerHTML = ''; // Clear any previous list

            if (data.success) {
                data.students.forEach(student => {
                    const li = document.createElement('li');
                    li.textContent = `${student.username} (${student.email})`;
                    joinedStudentsList.appendChild(li);
                });
            } else {
                alert(`Error: ${data.message}`);
            }
        })
        .catch(error => {
            console.error('Error fetching students:', error);
            alert('An error occurred while fetching the students.');
        });
    });
</script>
